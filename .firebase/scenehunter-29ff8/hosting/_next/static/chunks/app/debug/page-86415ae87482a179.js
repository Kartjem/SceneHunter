(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[302],{1033:(e,r,s)=>{Promise.resolve().then(s.bind(s,7152))},5159:(e,r,s)=>{"use strict";s.d(r,{n:()=>i});var o=s(5453),t=s(6786);let i=(0,o.v)()((0,t.Zr)((e,r)=>({user:null,userProfile:null,isLoading:!0,isAuthenticated:!1,setUser:r=>e({user:r,isAuthenticated:!!r,isLoading:!1}),setUserProfile:r=>e({userProfile:r}),setLoading:r=>e({isLoading:r}),logout:()=>e({user:null,userProfile:null,isAuthenticated:!1,isLoading:!1}),updateProfile:s=>{let o=r().userProfile;o&&e({userProfile:{...o,...s}})}}),{name:"auth-store",partialize:e=>({userProfile:e.userProfile,isAuthenticated:e.isAuthenticated})}))},5881:(e,r,s)=>{"use strict";s.d(r,{A:()=>d,AuthProvider:()=>l});var o=s(7536),t=s(2115),i=s(3004),n=s(6104),a=s(5159);let c=(0,t.createContext)(void 0);function l(e){let{children:r}=e,{user:s,isLoading:l,isAuthenticated:d,setUser:u,setLoading:p}=(0,a.n)();return(0,t.useEffect)(()=>((async()=>{try{let e=await (0,i.Q4)(n.j2);(null==e?void 0:e.user)&&console.log("Google redirect sign-in successful:",e.user)}catch(e){console.error("Redirect result error:",e),e&&"object"==typeof e&&"code"in e&&console.warn("Firebase redirect error:",e.code,e.message)}})().catch(e=>{console.error("Unhandled redirect result error:",e)}),(0,i.hg)(n.j2,e=>{try{u(e),p(!1)}catch(e){console.error("Auth state change error:",e),p(!1)}})),[u,p]),(0,o.jsx)(c.Provider,{value:{user:s,isLoading:l,isAuthenticated:d},children:r})}function d(){let e=(0,t.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6104:(e,r,s)=>{"use strict";s.d(r,{db:()=>d,j2:()=>l});var o=s(3915),t=s(3004),i=s(5317),n=s(858),a=s(9563);let c=(0,o.Wp)({apiKey:"AIzaSyBzYjserCFe5E7G4CX478rA3CuqVOML4f0",authDomain:"scenehunter-29ff8.firebaseapp.com",projectId:"scenehunter-29ff8",storageBucket:"scenehunter-29ff8.firebasestorage.app",messagingSenderId:"233532216462",appId:"1:233532216462:web:4639171ce802202e2865df"});try{let e="6LetZHWAAAAAN8LNWHuHBQbCZRUIpWrRVPA69uM";!e||e.startsWith("your-")?console.warn("Firebase App Check not initialized: Invalid or missing reCAPTCHA site key",{key:e?"".concat(e.slice(0,10),"..."):"undefined"}):((0,a.Ay)(c,{provider:new a.yG(e),isTokenAutoRefreshEnabled:!0}),console.log("Firebase App Check initialized successfully with reCAPTCHA Enterprise"))}catch(e){console.warn("Failed to initialize Firebase App Check (non-critical):",{message:null==e?void 0:e.message,code:null==e?void 0:e.code,details:e}),e&&"function"==typeof e.then&&e.catch(e=>{console.warn("Suppressed App Check promise rejection:",e)})}let l=(0,t.xI)(c),d=(0,i.aU)(c);(0,n.c7)(c)},7152:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>a});var o=s(7536);s(2115);var t=s(7306),i=s(3004),n=s(6104);function a(){let{user:e}=(0,t.t)(),r=async()=>{try{console.log("Triggering potential App Check error via Google sign-in...");let e=new i.HF;e.addScope("email"),e.addScope("profile"),await (0,i.df)(n.j2,e)}catch(e){if(console.error("Google sign-in error:",e),"auth/popup-blocked"===e.code){console.log("Popup blocked, trying redirect...");let e=new i.HF;e.addScope("email"),e.addScope("profile"),await (0,i.signInWithRedirect)(n.j2,e)}}};return(0,o.jsx)("div",{className:"min-h-screen bg-background p-8",children:(0,o.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Debug Page"}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"User Status"}),(0,o.jsxs)("p",{children:["Current user: ",e?e.email:"Not signed in"]})]}),(0,o.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Error Tests"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsx)("button",{onClick:r,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Test Google Sign-in (App Check)"}),(0,o.jsx)("button",{onClick:()=>{console.log("Triggering null promise rejection..."),Promise.reject(null)},className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600",children:"Test Null Rejection"}),(0,o.jsx)("button",{onClick:()=>{console.log("Triggering Firebase App Check error..."),Promise.reject({code:"appCheck/recaptcha-error",message:"ReCAPTCHA error simulated"})},className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Test Firebase Error"}),(0,o.jsx)("button",{onClick:()=>{console.log("Triggering undefined promise rejection..."),Promise.reject(void 0)},className:"px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600",children:"Test Undefined Rejection"})]})]}),(0,o.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Console Monitoring"}),(0,o.jsxs)("div",{className:"text-sm text-gray-600 space-y-2",children:[(0,o.jsx)("p",{children:"• Open browser console (F12) to see error handling in action."}),(0,o.jsx)("p",{children:"• Check for warning messages instead of error messages."}),(0,o.jsx)("p",{children:"• Null/undefined rejections should show as warnings, not errors."}),(0,o.jsx)("p",{children:"• App Check/reCAPTCHA errors should be handled gracefully."})]})]})]})]})})}},7306:(e,r,s)=>{"use strict";s.d(r,{U:()=>u,t:()=>d});var o=s(5881),t=s(2960),i=s(6715),n=s(5041),a=s(5317),c=s(6104),l=s(5159);function d(){var e,r;let s=(0,o.A)(),d=(r=null==(e=s.user)?void 0:e.uid,(0,t.I)({queryKey:["userProfile",r],queryFn:async()=>{if(!r)throw Error("User ID required");try{let e=(0,a.H9)(c.db,"users",r),s=await (0,a.x7)(e);if(s.exists())return s.data();return null}catch(e){throw console.error("Error fetching user profile:",e),e}},enabled:!!r,staleTime:3e5,retry:(e,r)=>(!r||"object"!=typeof r||!("code"in r)||"permission-denied"!==r.code&&"unauthenticated"!==r.code)&&e<3})),u=function(){let e=(0,i.jE)(),{setUserProfile:r}=(0,l.n)();return(0,n.n)({mutationFn:async e=>{try{let r={...e,createdAt:(0,a.O5)(),lastLoginAt:(0,a.O5)(),preferences:{theme:"system",language:"en",notifications:!0,...e.preferences},roles:["user"]};return await (0,a.BN)((0,a.H9)(c.db,"users",e.uid),r),r}catch(e){throw console.error("User profile creation failed:",e),e}},onSuccess:s=>{try{e.setQueryData(["userProfile",s.uid],s),r(s)}catch(e){console.error("Error updating query cache or store:",e)}},onError:e=>{console.error("Create user profile mutation error:",e)}})}(),p=async e=>{try{return new Promise((r,s)=>{u.mutate(e,{onSuccess:()=>{r()},onError:e=>{console.error("Create user profile error:",e),s(e)}})})}catch(e){throw console.error("Error calling createUserProfile:",e),e}};return{...s,userProfile:d.data,isProfileLoading:d.isLoading,profileError:d.error,createUserProfile:p,isCreatingProfile:u.isPending}}function u(e){if(e.code&&(e.code.includes("appCheck")||e.code.includes("recaptcha")||"app-check-token-invalid"===e.code||"appCheck/recaptcha-error"===e.code))return console.warn("App Check error (non-critical):",e.code,e.message),"Security verification temporarily unavailable, but you can still continue";switch(e.code){case"auth/user-not-found":return"No account found with this email";case"auth/wrong-password":return"Incorrect password";case"auth/invalid-email":return"Invalid email address";case"auth/user-disabled":return"This account has been disabled";case"auth/email-already-in-use":return"Email is already registered";case"auth/popup-blocked":return"Popup was blocked by browser. Please allow popups for this site or try again.";case"auth/popup-closed-by-user":case"auth/cancelled-popup-request":return"Sign-in was cancelled";case"permission-denied":return"Access denied";case"not-found":return"Data not found";case"unauthenticated":return"Authentication required";default:if(e.message&&(e.message.includes("AppCheck")||e.message.includes("App Check")||e.message.includes("reCAPTCHA")))return console.warn("App Check related error:",e),"Security verification service temporarily unavailable";return e.message||"An error occurred"}}}},e=>{var r=r=>e(e.s=r);e.O(0,[992,73,821,736,441,127,358],()=>r(1033)),_N_E=e.O()}]);